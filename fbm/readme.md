# Fractional Brownian Motion Simulation and Fractional Derivative Computation

This repository contains MATLAB scripts for simulating fractional Brownian motion (fBm) paths, computing their Riemann-Liouville fractional derivatives numerically, and estimating the fractal dimensions of the resulting processes.

These scripts have been developed with AI assistance from Grok 4.

The main script uses a fast fractional Gaussian noise generator and an FFT-based Grünwald-Letnikov approximation for efficient computation. Additional scripts provide fractal dimension estimates to validate the theoretical increase in roughness (fractal dimension) due to fractional differentiation.

**Important Note on Randomness and Accuracy**: Fractional Brownian motion is a stochastic (random) process, so each run generates a different path realization. For reliable results, especially when estimating properties like variance, power spectrum, or fractal dimensions, average over multiple independent runs (e.g., 10–100 simulations). Single-run estimates may vary due to sampling variability, but averaging improves statistical accuracy. Overall numeric accuracy is high for large num\_points (e.g., 1e6+1), with the script including validations for increment variance and power spectrum slope (expected ~-(2H+1)). The Grünwald-Letnikov approximation converges to the exact Riemann-Liouville derivative as max\_j increases and dt decreases, but truncation (max\_j=1e5) balances runtime and precision—errors are typically <1% for tested parameters, though rougher cases (low H - alpha) may show minor boundary effects. The fractal dimension tests provide a rough confirmation that the dimension increases linearly by alpha after applying the derivative, aligning with theory (D ≈ 2 - (H - alpha) for the graph).

## Scripts

### Script 1: fbm\_fractional\_derivative.m (Main Script)

**Purpose**  
Generates a fractional Brownian motion path with Hurst parameter H (0 < H < 1) using the zilany2014\_ffgn method (exact Davies-Harte for fGn), computes its Riemann-Liouville fractional derivative of order alpha (0 < alpha < H) via a shifted Grünwald-Letnikov approximation with FFT convolution for speed and accuracy, and saves the results. Validates the fBm generation via increment variance and power spectrum slope.

**Key Parameters**  
- H = 0.5: Hurst parameter.  
- alpha = 0.2: Fractional order.  
- num\_points = 1e6 + 1: Time points for high resolution.  
- t = linspace(0, 1, num\_points): Domain [0,1].  
- max\_j = min(1e5, num\_points-1): Truncation for Grünwald-Letnikov coefficients (adjust for accuracy vs. runtime).  

**Inputs**  
- None (parameters hardcoded; modify as needed).  

**Outputs**  
- plot.png: High-resolution plot (2400x1800 pixels) of fBm (red) and derivative (blue), with optional zoom.  
- values.csv: Full data [t, D^alpha B\_H(t)].  
- Console: Validation stats (variance at lags, PSD slope).  

**Usage**  
Run in MATLAB: Adjust parameters, execute the script. For zoom, input [x\_min x\_max] at prompt or leave empty for full view. Higher num\_points enhances accuracy but increases runtime/memory.  

**Notes**  
- fBm normalization: Var(B\_H(1)) ≈ 1.  
- Derivative: Accurate for alpha away from 0/H boundaries; check for NaN/Inf.  
- zilany2014\_ffgn: Handles H>1 if needed, but here 0<H<1.  
- Alternative fBm: Uncomment Wavelet Toolbox method if available.  

### Script 2: fractal\_dimension\_estimate.m

**Purpose**  

Estimates the box-counting (Hausdorff) dimension of the graph of D^alpha W(x) from values.csv using a refined vertical-span method: divides x into boxes of size epsilon over a wide range, computes N(epsilon), and automatically selects the best linear segment (max R^2 window) in the log-log plot for the fit to capture the self-similar regime.

**Key Parameters**  

- numSizes = 40: Number of epsilon values for detailed log-log curve.
- epsilon range: Geometric sequence from dx/1000 to dx/2 (dx = domain width; wide coverage to identify intermediate scales).
- Window search: Sliding windows of 10-20 points for max R^2 fit.

**Inputs**  

- values.csv (generated by Script 1).

**Outputs**  

- Console: Estimated dimension (e.g., ~1.36 for alpha=0) and R^2 of fit (>0.99 expected).
- dimension\_fit.png: Log-log plot (2400x1800 pixels) with full data (red), best window (green), fit line, legend, and grid.

**Usage**  

- Run Script 1 to generate values.csv.
- Run this script in MATLAB. Higher point count in Script 1 improves accuracy (e.g., 1.36 at 500k points for alpha=0).

**Notes**  

- This refined box-counting method focuses on the self-similar regime to reduce bias from sampling artifacts.
- Analytic dimension: D = 2 + (ln(a) / ln(b)) + alpha ≈ 1.569 (for given parameters), where the increase by alpha reflects the added roughness from the fractional derivative [2].
- Numerical estimate approaches analytic value with finer sampling but plateaus due to truncation (N=20 sufficient; no need for N=50).
- R^2 indicates fit quality; if <0.95, increase points in Script 1.

### Script 3: higuchi\_dimension\_estimate.m

**Purpose**  

Estimates the fractal dimension of the graph of D^alpha W(x) from values.csv using Higuchi's method: computes multi-scale curve lengths L(k) at lags k=1 to kmax, fits the slope of log L(k) vs. log k, and derives D = 1 - slope. Robust for self-affine signals.

**Key Parameters**  

- kmax = min(200, floor(N/4)): Maximum lag for stability (N = data length).
- Normalization: Standard Higuchi formula for curve length averaging over subseries.

**Inputs**  

- values.csv (generated by Script 1).

**Outputs**  

- Console: Estimated dimension (e.g., 1.569 for alpha=0.2) and R^2 of fit (>0.99 expected).
- higuchi\_fit.png: Semi-log plot (2400x1800 pixels) with full data (red), fitted lags (green), fit line, legend, and grid.

**Usage**  

- Run Script 1 to generate values.csv.
- Run this script in MATLAB. Higher point count in Script 1 improves accuracy (e.g., 1.569 for alpha=0.2 at 500k points).

**Notes**  

- Higuchi's method is particularly effective for self-affine fractals like the Weierstrass derivative, providing estimates within ~0.01 of analytic values at high resolution.
- For alpha=0, expect ~1.37 (close to analytic 1.369); for alpha=0.2, ~1.569.
- Limitations: Sensitive to kmax choice and noise; best for monofractal, self-affine signals.

## General Usage

1. Set parameters in Script 1 and run to generate fBm and derivative data.  
2. Run Script 2 and/or 3 for dimension estimates.  
3. For validation, compare numerical dimensions to theory (D ≈ 2 - (H - alpha) for the graph).  

## Requirements

- MATLAB (base; optional Wavelet Toolbox).  
- No external dependencies beyond included subfunction.

## Example plots

This repository contains some example plots with parameters encoded in the title. For example ExampleH0.5alpha0.2(dim1.685).png: H = 0.5, alpha = 0.2, D = 1.685.  

## References

- zilany2014\_ffgn: Based on Davies-Harte method for exact fGn simulation. Derived from [the AMT toolbox implementation](https://www.amtoolbox.org/amt-1.6.0/doc/modelstages/zilany2014_ffgn_code.php) (GPLv3).
  
- Fractional derivatives: Riemann-Liouville via Grünwald-Letnikov approximation.  
- Fractal dimensions: Box-counting and Higuchi methods for self-similar processes.  

For questions or improvements, feel free to contribute!