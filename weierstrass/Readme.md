# Readme

## Overview
This repository contains three MATLAB scripts for analyzing the Weierstrass function, a classic example of a fractal curve. The first script computes the Riemann-Liouville fractional derivative of the Weierstrass function using its analytic term-by-term expression and generates a plot and data file. The second script estimates the fractal (box-counting) dimension of the derivative's graph from the generated data using a refined box-counting method with automatic linear segment selection. The third script uses Higuchi's method for an alternative, robust dimension estimate.

These scripts are designed for educational or research purposes in fractional calculus and fractal geometry. They assume MATLAB R2020a or later (for `exportgraphics`).

## Script 1: `weierstrass_fractional_derivative.m`
### Purpose
Computes the Weierstrass function W(x) = sum from n=0 to N-1 of a^n * cos(b^n * pi * x) and its Riemann-Liouville fractional derivative of order alpha, D^alpha W(x) = sum from n=0 to N-1 of a^n * (b^n * pi)^alpha * cos(b^n * pi * x + alpha * pi / 2), over x in [0, 2]. Plots the function (red) and derivative (blue), saves the plot as `plot.png` (2400x1800 pixels), and exports the derivative values to `values.csv`.

### Key Parameters
- `a = 0.5`: Scaling factor (0 < a < 1).
- `b = 3`: Frequency multiplier (integer >1; ab >1 for convergence).
- `N = 20`: Number of terms (increase for better approximation; e.g., 30+ for finer detail).
- `alpha = 0.2`: Fractional order (0 < alpha < 1).
- Domain: `x = linspace(0, 2, num_points)` (default 500000 points).

### Outputs
- `plot.png`: Plot without title or legend, x-label "x", no y-label.
- `values.csv`: Two columns (x, D(alpha) W(x)).

### Usage
Run the script in MATLAB. Adjust parameters as needed. For higher resolution, set `x = linspace(0, 2, 500000);` (may require more memory).

### Notes
- Uses finite truncation; errors decrease geometrically (e.g., max error ~10^{-4} for derivative at N=20).
- The analytic expression for the fractional derivative is obtained by term-by-term application of the standard Riemann-Liouville derivative formula for cosine functions [1].
- Plot saved with exact pixel dimensions via `exportgraphics`.

## Script 2: `fractal_dimension_estimate.m`
### Purpose
Estimates the box-counting (Hausdorff) dimension of the graph of D^alpha W(x) from `values.csv` using a refined vertical-span method: divides x into boxes of size epsilon over a wide range, computes N(epsilon), and automatically selects the best linear segment (max R^2 window) in the log-log plot for the fit to capture the self-similar regime.

### Key Parameters
- `numSizes = 40`: Number of epsilon values for detailed log-log curve.
- epsilon range: Geometric sequence from `dx/1000` to `dx/2` (dx = domain width; wide coverage to identify intermediate scales).
- Window search: Sliding windows of 10-20 points for max R^2 fit.

### Inputs
- `values.csv` (generated by Script 1).

### Outputs
- Console: Estimated dimension (e.g., ~1.36 for alpha=0) and R^2 of fit (>0.99 expected).
- `dimension_fit.png`: Log-log plot (2400x1800 pixels) with full data (red), best window (green), fit line, legend, and grid.

### Usage
1. Run Script 1 to generate `values.csv`.
2. Run this script in MATLAB. Higher point count in Script 1 improves accuracy (e.g., 1.36 at 500k points for alpha=0).

### Notes
- This refined box-counting method focuses on the self-similar regime to reduce bias from sampling artifacts.
- Analytic dimension: D = 2 + (ln(a) / ln(b)) + alpha ≈ 1.569 (for given parameters), where the increase by alpha reflects the added roughness from the fractional derivative [2].
- Numerical estimate approaches analytic value with finer sampling but plateaus due to truncation (N=20 sufficient; no need for N=50).
- R^2 indicates fit quality; if <0.95, increase points in Script 1.

## Script 3: `higuchi_dimension_estimate.m`
### Purpose
Estimates the fractal dimension of the graph of D^alpha W(x) from `values.csv` using Higuchi's method: computes multi-scale curve lengths L(k) at lags k=1 to kmax, fits the slope of log L(k) vs. log k, and derives D = 1 - slope. Robust for self-affine signals.

### Key Parameters
- `kmax = min(200, floor(N/4))`: Maximum lag for stability (N = data length).
- Normalization: Standard Higuchi formula for curve length averaging over subseries.

### Inputs
- `values.csv` (generated by Script 1).

### Outputs
- Console: Estimated dimension (e.g., 1.569 for alpha=0.2) and R^2 of fit (>0.99 expected).
- `higuchi_fit.png`: Semi-log plot (2400x1800 pixels) with full data (red), fitted lags (green), fit line, legend, and grid.

### Usage
1. Run Script 1 to generate `values.csv`.
2. Run this script in MATLAB. Higher point count in Script 1 improves accuracy (e.g., 1.569 for alpha=0.2 at 500k points).

### Notes
- Higuchi's method is particularly effective for self-affine fractals like the Weierstrass derivative, providing estimates within ~0.01 of analytic values at high resolution.
- For alpha=0, expect ~1.37 (close to analytic 1.369); for alpha=0.2, ~1.569.
- Limitations: Sensitive to kmax choice and noise; best for monofractal, self-affine signals.

## Dependencies
- MATLAB base (no toolboxes required; `polyfit` is core functionality).

## Example Results
- Box-counting (Script 2) at 500k points: ~1.36 (alpha=0), R^2 ≈0.999.
- Higuchi (Script 3) at 500k points: 1.37 (alpha=0), 1.569 (alpha=0.2), R^2 ≈0.999.
- Both methods show linear scaling in intermediate regimes, where the fractal dimension increases linearly with alpha according to the analytic formula D = D0 + alpha (with D0 ≈1.369 for the original function); this linear increase holds only in the intermediate regime of 0 ≤ alpha ≤ 2 - D0 ≈ 0.631, beyond which the dimension saturates at 2 as the graph becomes space-filling. Higuchi is more robust for self-affine curves.

## References
[1] M. Zähle and H. Ziezold, "Fractional Derivatives of Weierstrass-Type Functions," *Journal of Computational and Applied Mathematics*, vol. 76, pp. 265-275, 1996. [DOI: 10.1016/S0377-0427(96)00110-0](https://doi.org/10.1016/S0377-0427(96)00110-0)

[2] K. Yao, "The Fractional Derivatives of a Fractal Function," *Acta Mathematica Sinica, English Series*, vol. 22, no. 6, pp. 719-722, 2006. [DOI: 10.1007/s10114-005-0644-z](https://doi.org/10.1007/s10114-005-0644-z)